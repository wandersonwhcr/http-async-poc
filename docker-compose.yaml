version: "3.8"

services:

  broker:
    image: "rabbitmq:3.8"

  handler:
    image: "node:15.10"
    volumes:
    - "./projects/handler:/app"
    ports:
    - "80:3000"
    working_dir: "/app"
    environment:
      AMQP_URL: "amqp://broker"
      PORT: "3000"
    command: ["npm", "run", "watch"]

  worker:
    image: "node:15.10"
    volumes:
    - "./projects/worker:/app"
    working_dir: "/app"
    environment:
      AMQP_URL: "amqp://broker"
    command: ["npm", "run", "watch"]
